{% extends "front_page/base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load thumbnail %}

{% block head %}
<meta property="fb:app_id" content="{{ app_id }}" />
<meta property="og:url" content="{{ get_domain }}{{ object.get_absolute_url }}"/>
<meta property="og:type" content="article" />
<meta property="og:title" content="{{ object.title }}" />
<meta property="og:image" content="{{ MEDIA_URL }}{{ object.image }}" />
<meta property=”og:description” content="{{ object.meta_description }}" />

<link rel="canonical" href="{{ get_domain }}{{ object.get_absolute_url }}"/>
<meta name="description" content="{% if object.meta_description %}{{ object.meta_description }}{% else %}Artykuł na blogu o tylule {{ object.title }}{% endif %}">
<title>{% if object.meta_title %}{{ object.meta_title }}{% else %}Artykuł | {{ object.title }}{% endif %}</title>
{% endblock %}


{% block content %}
<nav id="link_map" aria-label="breadcrumb" class="col-12 bg-white mx-auto d-md-none row">
    <li class="breadcrumb-item active" aria-current="page"><a href="{% url 'front_page' %}">Strona startowa</a></li>
    <li class="breadcrumb-item active" aria-current="page"><a href="{% url 'articles_list' %}">Blog</a></li>
    <li class="breadcrumb-item text-dark active" aria-current="page">{{ object.title }}</li>
</nav>

<div class="col-12 col-md-9 mx-auto ml-0 mr-0 p-0 offer mt-2 row">
    <h1 class="col-11 text-center mx-auto mt-3 mb-3">{{ object.title }}</h1>
    <span class="col-12 text-center mb-3">{{ object.category.name }}</span>
    <div class="col-12 col-sm-11 m-0 p-0 mb-3 mx-auto imgWrap">
        {% thumbnail object.image "800x300" crop='center' format="WEBP" as im %}
        <source srcset="{{ im }}" type="image/webp" />
        <img width="800" height="300" class="img-fluid mx-auto col-12 m-0 p-0" src="{{ MEDIA_URL }}{{ im }}"
            alt="{{ object.image_alt }}" title="{{ object.image_title }}">
        {% endthumbnail %}
    </div>
    <p class="col-10 mx-auto text-center text-danger">{{ object.created_time }}</p>
    <div class="col-12 mx-auto col-sm-11 m-0 p-0 mb-3 mx-auto row">
        {{ object.body|safe }}
    </div>
    {% for image in object.images %}
            {% load thumbnail %}
            {% thumbnail image.image "1280" crop='center' format="WEBP"  as im %}
            <a href="{{ MEDIA_URL }}{{ im }}" data-lightbox="{{ image.article.id }}" data-title="{{ image.article.name}}"
                class="mx-auto text-center p-0 m-0 mt-2" title="Galeria zdjęć produktu {{image.object.name}}">
                {% thumbnail  image.image "150" crop='center' format="WEBP"  as im %}
                <source srcset="{{ im }}" type="image/webp" />
                <img class="img-fluid mx-auto m-1 border" src="{{ MEDIA_URL }}{{ im }}" alt="{{image.alt}}" title="{{image.title}}">
                {% endthumbnail %}
            </a> 
            {% endthumbnail %}
            {% empty %}
            <small class="ml-auto pr-1 col-12 text-center">Brak zdjęć w galerii</small>
            {% endfor %}
</div>
{% endblock %}

{% block script %}
<script type="application/ld+json">
    {
      "@context": "https://schema.org/",
      "@type": "Article",
      "name": "{{ object.title }}",
      "image": ["{{ get_domain }}{{ MEDIA_URL }}{{ object.image }}",
      {% for image in object.images %}"{{ get_domain }}{{ MEDIA_URL }}{{ image.image }}",{% endfor %}
      ],
      "description": "{{ object.body }}",
      "contentReferenceTime": {{ object.created_time }}
    }
    </script>
{% endblock %}